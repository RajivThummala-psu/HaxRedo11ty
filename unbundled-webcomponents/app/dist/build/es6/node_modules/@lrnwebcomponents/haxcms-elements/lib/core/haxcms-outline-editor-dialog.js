import{LitElement,html,css}from"../../../../lit-element/lit-element.js";import{store}from"./haxcms-site-store.js";import{autorun,toJS}from"../../../../mobx/lib/mobx.module.js";import"../../../json-outline-schema/json-outline-schema.js";import"../../../editable-outline/editable-outline.js";import"../../../../@polymer/paper-button/paper-button.js";import"../../../../@polymer/iron-icon/iron-icon.js";import"../../../../@polymer/iron-icons/iron-icons.js";class HAXCMSOutlineEditorDialog extends LitElement{static get styles(){return[css`
        :host {
          display: block;
          height: 60vh;
          min-width: 50vw;
        }
        .buttons {
          position: absolute;
          bottom: 0;
          z-index: 1000000;
          background-color: var(--simple-modal-titlebar-background, #000000);
          color: var(--simple-modal-titlebar-color, #ffffff);
          left: 0;
          right: 0;
        }
        .buttons paper-button {
          color: #ffffff;
          background-color: var(--simple-modal-button-background, #000000);
        }
        editable-outline:not(:defined),
        paper-button:not(:defined) {
          display: none;
        }
        #toggle {
          float: right;
          text-transform: unset;
        }
        #savebtn {
          color: white;
          background-color: var(--haxcms-color, #2196f3);
        }
        editable-outline {
          margin-bottom: 32px;
        }
      `]}static get tag(){return"haxcms-outline-editor-dialog"}render(){return html`
      <editable-outline
        id="outline"
        edit-mode
        .hidden="${this.viewMode}"
        .items="${this.manifestItems}"
      ></editable-outline>
      <div class="buttons">
        <paper-button id="savebtn" dialog-confirm @click="${this._saveTap}"
          ><iron-icon icon="icons:save"></iron-icon>Save</paper-button
        >
        <paper-button dialog-dismiss
          ><iron-icon icon="icons:cancel"></iron-icon>Cancel</paper-button
        >
      </div>
    `}constructor(){super(),this.__disposer=[],this.viewMode=!1}static get properties(){return{opened:{type:Boolean},manifestItems:{type:Array},manifestItemsStatic:{type:String,attribute:"manifest-items-static"},viewLabel:{type:String,attribute:"view-label"},viewMode:{type:Boolean,attribute:"view-mode"}}}updated(changedProperties){changedProperties.forEach((oldValue,propName)=>{"opened"==propName&&this.dispatchEvent(new CustomEvent("opened-changed",{detail:this[propName]})),"manifestItems"==propName&&(this._manifestItemsChanged(this[propName],oldValue),this.dispatchEvent(new CustomEvent("manifest-edit-mode-changed",{detail:this[propName]})))})}_manifestItemsChanged(newValue){newValue&&(window.JSONOutlineSchema.requestAvailability().items=newValue,this.manifestItemsStatic=JSON.stringify(newValue,null,2))}firstUpdated(){this.shadowRoot.querySelector("#outline").importJsonOutlineSchemaItems()}connectedCallback(){super.connectedCallback(),autorun(reaction=>{this.manifestItems=[...toJS(store.manifest.items)],this.__disposer.push(reaction)})}disconnectedCallback(){for(var i in this.__disposer)this.__disposer[i].dispose();super.disconnectedCallback()}_saveTap(e){window.dispatchEvent(new CustomEvent("haxcms-save-outline",{bubbles:!0,composed:!0,detail:this.shadowRoot.querySelector("#outline").exportJsonOutlineSchemaItems(!0)}))}}window.customElements.define(HAXCMSOutlineEditorDialog.tag,HAXCMSOutlineEditorDialog);export{HAXCMSOutlineEditorDialog};