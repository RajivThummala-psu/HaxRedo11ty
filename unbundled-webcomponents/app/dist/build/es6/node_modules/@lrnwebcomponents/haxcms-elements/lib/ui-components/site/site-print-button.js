/**
 * Copyright 2019 The Pennsylvania State University
 * @license Apache-2.0, see License.md for full text.
 */
import{LitElement,html,css}from"../../../../../lit-element/lit-element.js";import{store}from"../../core/haxcms-site-store.js";import"../../../../../@polymer/polymer/lib/elements/custom-style.js";class SitePrintButton extends LitElement{static get styles(){return[css`
        :host {
          display: block;
          text-rendering: optimizelegibility;
          position: relative;
        }
      `]}static get tag(){return"site-print-button"}constructor(){super(),this.icon="icons:print",this.position="bottom",this.type="page",import("../../../../simple-tooltip/simple-tooltip.js"),import("../../../../../@polymer/paper-icon-button/paper-icon-button.js")}render(){return html`
      <custom-style>
        <style>
          paper-icon-button {
            @apply --site-print-button-button;
          }
          paper-icon-button:hover,
          paper-icon-button:focus,
          paper-icon-button:active {
            @apply --site-print-button-button-hover;
          }
          simple-tooltip {
            @apply --site-print-button-tooltip;
          }
        </style>
      </custom-style>
      <paper-icon-button
        id="btn"
        icon="${this.icon}"
        @click="${this.print}"
        .title="${this.label}"
        ?disabled="${this.disabled}"
      ></paper-icon-button>
      <simple-tooltip for="btn" position="${this.position}" offset="14">
        ${this.label}
      </simple-tooltip>
    `}updated(changedProperties){changedProperties.forEach((oldValue,propName)=>{"type"==propName&&this._typeChanged(this[propName],oldValue)})}static get properties(){return{icon:{type:String},disabled:{type:Boolean,reflect:!0},label:{type:String},position:{type:String},type:{type:String}}}_typeChanged(newValue){void 0===this.label&&(this.label="page"===newValue||"site"===newValue?"Print "+newValue:"Print outline")}async print(e){import("../layout/site-footer.js");const type=this.type;let content="";if("page"===type)content=`\n      <h1>${store.activeItem.title}</h1>\n      <div>${store.activeItemContent}</div>`;else if("parent"===type){const result=store.computeItems(1,100,store.activeId,"parent",store.routerManifest,!0);for(var i in result)content+=await fetch(result[i].location).then((function(response){return response.text()})).then((function(response){let indent=result[i].indent+1;return indent>6&&(indent=6),`<h${indent}>${result[i].title}</h${indent}>\n              ${response}`}))}else if("ancestor"===type){const result=store.computeItems(1,100,store.activeId,"ancestor",store.routerManifest,!0);for(var i in result)content+=await fetch(result[i].location).then((function(response){return response.text()})).then((function(response){let indent=result[i].indent+1;return indent>6&&(indent=6),`<h${indent}>${result[i].title}</h${indent}>\n              ${response}`}))}else if("site"===type){const result=store.routerManifest.items;for(var i in result)content+=await fetch(result[i].location).then((function(response){return response.text()})).then((function(response){let indent=result[i].indent+1;return indent>6&&(indent=6),`<h${indent}>${result[i].title}</h${indent}>\n              ${response}`}))}var currentdate=new Date,datetime="Printed on: "+currentdate.getDate()+"/"+(currentdate.getMonth()+1)+"/"+currentdate.getFullYear()+" at "+currentdate.getHours()+":"+currentdate.getMinutes()+":"+currentdate.getSeconds();let element=document.createElement("div");element.innerHTML=`\n<style>\n  @media print {\n    body {\n      padding: 0 15px 5px;\n      color: #000;\n      background-color: #ffffff;\n      border-top: 1px solid #aaa;\n    }\n  }\n</style>\n<h1>${store.siteTitle}</h1>\n<site-footer></site-footer>\n<p>${datetime}</p>\n${content}`;let print=window.open("","","left=0,top=0,width=800,height=800,toolbar=0,scrollbars=0,status =0");if(document.head.getElementsByTagName("base")){let base=document.createElement("base");base.href=document.head.getElementsByTagName("base")[0].getAttribute("href"),print.document.head.appendChild(base)}print.document.body.appendChild(element),print.document.close(),print.focus(),print.print(),print.close()}}window.customElements.define(SitePrintButton.tag,SitePrintButton);export{SitePrintButton};